/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2025 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */

#include <stdint.h>
#include <mem_io.h>
#include <gpio.h>
#include <rcc.h>
#include <usart.h>
#include <exti.h>
#include <ltdc.h>
#include <fmc.h>
#include <spi.h>

void delay_us(uint32_t us) {
    for (volatile uint32_t i = 0; i < us ; ++i) {
        __asm__("nop");
    }
}


int main(void)
{
	gpio_init();
	usart_init();
	exti_init();
	spi_init();
	ili9341_init();
	ltdc_init();

	usart_printf("LTDCEN = %d\r\n", (io_read(LTDC_BASE + LTDC_GCR_OFFSET) >> 0) & 1);
	usart_printf("SRCR = 0x%x\r\n", io_read(LTDC_BASE + LTDC_SRCR_OFFSET));


	// fmc_init();
	// sdram_self_test();


	gpio_set_outdata(GPIOG_BASE, GPIO_PIN_13, 1);
	gpio_set_outdata(GPIOG_BASE, GPIO_PIN_14, 1);

	usart_print(USART1_BASE, "USART\r\n");
	usart_write(USART1_BASE, 't');
	usart_write(USART1_BASE, 'e');
	usart_write(USART1_BASE, 'x');
	usart_write(USART1_BASE, 't');
	usart_write(USART1_BASE, '\r');
	usart_write(USART1_BASE, '\n');


    while (1)
    {
    	usart_printf("enter while \r\n");
    	delay_us(1000000);

    }
}
