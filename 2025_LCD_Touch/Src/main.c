/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2025 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */

#include <stdint.h>
#include <mem_io.h>
#include <gpio.h>
#include <rcc.h>
#include <usart.h>
#include <exti.h>

int main(void)
{
	gpio_init();
	usart_init();
	exti_init();

	gpio_set_outdata(GPIOG_BASE, GPIO_PIN_13, 1);
	gpio_set_outdata(GPIOG_BASE, GPIO_PIN_14, 1);

	usart_print(USART1_BASE, "USART\r\n");
	usart_write(USART1_BASE, 't');
	usart_write(USART1_BASE, 'e');
	usart_write(USART1_BASE, 'x');
	usart_write(USART1_BASE, 't');
	usart_write(USART1_BASE, '\r');
	usart_write(USART1_BASE, '\n');

	/*
	ltdc_gpio_init();             // ✅ Step 1: LTDC 所有 RGB 腳設為 AF14（PJ/PK/PI 為主）
	sdram_gpio_init();            // ✅ Step 2: FMC/SDRAM 所有控制腳設為 AF12（PD/PE/PF/PG/PH）

	sdram_init();                 // ✅ Step 3: 正確設定 SDCR[0] / SDTR[0] → Bank1 初始化
	test_sdram_single_access();   // ✅ Step 4: 嘗試寫入 SDRAM[0] 並讀出，確認硬體真的可用
	sdram_self_test();            // ✅ Step 5: 批量測試 SDRAM 讀寫功能（你已有函式）

	ltdc_clock_init();            // ✅ Step 6: （建議補上）設定 pixel clock 來源（使用 PLLSAI）
	ltdc_init();                  // ✅ Step 7: 初始化 LTDC 圖層與解析度、frame buffer 設定
	lcd_clear_red();              // ✅ Step 8: 將整個 SDRAM frame buffer 填上紅色（0xF800）
	ltdc_start_display();         // ✅ Step 9: 啟動 shadow reload，開始送畫面
	*/

    while (1)
    {
    	usart_printf("-123 + 23 = 100.00; %d \r\n",21);
    	for (volatile int i = 0; i < 1000000; i++); // about 1 second

    }
}
