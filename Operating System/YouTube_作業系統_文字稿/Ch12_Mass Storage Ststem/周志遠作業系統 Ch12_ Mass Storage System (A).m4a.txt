undefined
好，那接下來我們就move on，所以file system講完之後我們就開始越走越底層，所以file system下面用到什麼呢，當然就是storage。所以，storage跟file system差別在於file File System管理的是File那個Logical的東西，那當我們在談Storage System的時候呢，通常就只在更Low Level已經到了，就是那個Physical的Storage Device的Management的部分。那當然我們這邊Mask就是Storage System就對了。所以為什麼會提到Mask呢？最主要原因就是我們後面會介紹如何用多個Storage或者說多個這個Disk

去拼出一個更reliable或是performance更好的storage system，因為我們知道現在其實我們這個年代做法就是這樣Hardware當然有在improve，但是更多其實是靠現有的Hardware把它兜起來，然後透過software透過管理的概念，然後製造出一個其實更powerful更便宜或是更效能更好的storage system出來。所以，software的重要性非常非常的大就是這樣子好，那，所

以我們可以看見一開始我們會剪這邊，我們只是講Disk，因為Disk還是so far還是目前最populer最常見的這個storage的system當然我們知道現在很多很有趣的像SSD啊或是甚至於現在有這個Flash所以很多很有趣的storage的這些device跑出來了，但是我目前當然就只能先從介紹最基本的這個 Hard Drive 的構造開始，好然後介紹裡面的 Disk

需要 Scheduling，所以指的是什麼就是讀寫頭的這個移動的方法，那最後就是這個RAID 非常重要，因為其實大家去店裡面你都可以看見你都可以買到的就是RAID System那所以上完這堂課大家就會知道有點概念什麼是RAID好，所以我們首先就先講這個Disk Structure所以Storage這邊我們就以Hard Drive當作一個例子，那所以Disk

基本上我們說過他就會切成這個Block然後是這個Logical的這個Operation的動作，就我們剛剛接續剛剛File System最後他就要讀這些Block那這些Block其實他會去Map到的是Sector，所以block其實就有很多個sector來組成所以我們說過一個disk其實它是有分成好幾個讀寫盤嘛，然後一個讀寫盤有好幾個track一圈一圈的，然後再

把它切成sector，那一個data block就可能對到一個或者是多個sector，那這些sector所以當然很重要就是它要有ID，所以我們才能知道identify它然後可以做mapping的動作對不對那這只是中心化通常可能它就是從最內圈最外圈的第一個 track 開始反正無所謂 大家可以想見當然是希望它連續這個連續非常非常重要. from哪邊開始其實無所謂重點是你的這個 number一定要是有關聯就是有連續的現象為什麼

因為我們知道硬碟的讀寫最好就是順著它移動的方式去讀寫 對不對所以這個number其實往往也就indicate了他讀寫要跳動的距離要移動的距離所以我們之後再講schedule algorithm大家就會看見怎麼樣最好schedule algorithm其實就是去minimize移動的距離距離其實根據他的number你就可以知道了

知道它怎麼做labeling之後接下來我們就要看它這種這些這種drive它到底是怎麼移動的那它的移動在我們這邊來講除了傳統的hard drive其實像剛才這種磁盤的這種的storage device我們知道另外一個就是像是CD-ROM和DVD-ROM對不对所以這種就是磁盤啦所以就是這種類似的那所以這些不同的這種都是磁盤但是因為它移動方式的不同我們又可以把它分成

兩種類型。第一個叫做CLV(Constant Linear Velocity)這個做法是內圈的速度要變快所以這個做法是越是外圈的對不對所以它放的這個越外圈的話我們知道它空間越大所以它存的sector會越多就是它可以存的資料量是越大的所以今天如果你要維持相同的讀取的速度的話那麼你在讀外圈的時候因為它資

料量比較多嘛，所以你轉一圈你不用轉得這麼快就是你可以讀10個byte你可以讀10個megabyte它可能只需要讀比如說30度角度的這個面積就好可是如果內圈因為它你能夠存的sector數量比較少因為面積小嘛 對不對所以說你的內圈你能夰讀出來資料量就會比較少，所以為了要維持相同的資料讀取的速度你在外圈的時候

你就可以轉得慢一點反正你不需要讀一整圈的資料你讀一整圈資料你只需要讀它一半的資料但是內圈因為它的空間比較少你存的資料量比較少，所以你要讀相同的資料量你就必須要把它整圈都把它讀完所以結果就是你為了要deliver相同的資料的讀取的速度所以外圈的時候你可以轉得慢一點但是當讓你找到內圈的時候

因為你要讀很多圈才有辦法讀出相同的資料量你的速度讀取的速度轉的速度就要加快，所以大家在讀CD-ROM的時候你會發現有時候它會突然很快，然後很慢大家應該有這個經驗在放一些對 DVD player 的時候你會發現他有時候會突然間加速然後聲音變得很大，然後有時候聲音又是好像轉得比

較慢為什麼就是因為，如果他是在讀內圈的時候通常他會加速他必須要轉得更快一點他才有辦法在每秒鐘讀出相同的資料量，因為內圈空間小存的資料少所以他的讀取的轉動的速度變得是不一致。 Depends on你現在讀的位置是在你內圈還是外圈，所以這個是第一種他在去讀取的時候讀寫頭要去配合跟存取資料的方式是這個樣子好，那第二個做法是我們剛才講的是Constant Angle Velocity，意思就是說他每一次他不管是內圈還是外圈，他希望他

轉動的只要角度相同讀出來的資料量就是相同，所以叫做angle velocity，因為它是以angle為角度，每一個讀的角度只要相同，那麼資料量就要相同，因為我們知道它轉的時候它的目的就是它希望它的rotation的速度要一致也就是今天不管我們資料是讀內圈的資料還是外圈的資料，我整個磁盤的轉動就是每秒鐘7,200轉，

所以大家去買硬碟的時候其實大家應該都有注意到為什麼有些硬碟貴有些便宜，第一個當然是你會發現有什麼白標藍標代表它容不容易壞啦，那另外一個當然是size不用講第三個你一定要注意看的不然錢就被騙走了就是它的它會講它的rotation speed每秒3200轉還是3600轉或是7200轉而且比較常見這兩個

所以意思就是說它的rotation speed always就是那個樣子它每秒鐘它就是7200轉不管你資料放哪裡怎麼樣去用它它就是維持那個固定的速度因為它每秒鐘能夠移動的角度是固定的這就是硬碟的特性那在這樣子的特性之下因為你的移動的速度每一個角度是固定的所以自然你在存這個資料的時候就必須為了配合它

所以在外圈的它的density就必須要比較的疏鬆了對不對因為其實面積很大嘛同樣的角度外圈面積很大可是你要它讀出來的資料量要相同啊所以你就不需要存那麼密所以它的sector越外圈它會越長越寬那越內圈它的density就會越密越小才確保它一樣它的data的rate要維持一樣因為對於軟體而言就是這樣凡事就是越穩定越predictable 越好所以 hardware

這邊你就要去配合這一點去 figure out 怎麼做才可以配合它所以 eventually都要 deliver 相同的 data rate這是最重要的事情但是因為我們面積的問題所以你就有兩種選擇要嘛改變你讀取的速度隨著你的內圈外圈改變速度或者是改變你儲存的 density那這樣你的速度就不必改變了對不對所以就是看你怎麼做調整那這就是標準的Hard Drive就是第二類型的這種Storage System好那知道怎麼去擺放怎麼去把它讀出來它的機械上面運作的一些基本的方法之後

當然我們跟最後整個系統要連接就是要去attach對不對就是我們要把這些IoDevice要attach到我們的系統裡面Computer System裡面讓它可以做Io對不對那這個部分怎麼做Io我們Io的Subsystem其實是下一章解所以我們下一次再會講detail但基本上我們知道的就是它會透過Controller就是我們之前也都有介紹過的就會分成

其實會有兩邊所以computer system這邊會有host controller所以通常就是controller card或者是你就有monitor board上的一個device甚至於你叫CPU直接controller就是host的這邊你本來就要有controller那drive這邊也必須要一個controller通常你是disk那就是disk drive那兩邊就是兩個computing的小unitIO unit就要去溝通來去做他去運作那中間溝通對不对所以你透過什麼樣子的這個連接的方式或是怎麼樣的 protocol就是我們常常會看到的一些SATA等等對不對

排線那個就是中間的bus你要怎麼去把他接起來的部分那當然每種bus有他自己的這個polar code對不對還有他自己傳輸資料的一些特性那就是這兩邊sender receiver 對不對兩個人去溝通好那你才可以傳資料這個detail我們會在下一章解才會講所以這邊大家只要稍微知道就好好那接下來我們就要進入管理Disk這邊比較重要的一些部分所以第一個

issue就是Disk的scheduling algorithm所以Disk本身它會接受到很多的IO request對不對就是來自於file system甚至於其他的任何的這個像Database任何的Software所以這邊已經只到最low level所以是已經到Disk已經到Driver的下面了所以任何Application它都可以產生同時甚至於產生各式各樣的Ion Request下來對不對那Disk的Controller它接到這個Request之後那它要做一個決定到底我要怎麼樣子按照什麼樣的順序

來去處理這些 IELTS Request也就是怎麼樣去把這些資料給讀出來那Disk Scheduling 的目的當然就是要減少讀寫的時間對不對所以第一個我們就要先來看一下Disk 讀寫的時間到底是怎麼算出來或者是可以怎麼樣被一個 Model 出來的那所以 Disk 的 Access Time這邊純粹是 Disk所以這當然就跟這個 Hardware 它的設計

運作是息息相關的所以我們都知道這個Hard Drive的運作就是這樣對不對我們有讀很多的讀寫盤第一個當然它會Rotate就是我們剛才提到的事情然後對於Disk而言的話它其實Rotate的速度像我們剛才說它是Constant所以我們其實不用去管它到底是在內圈還外圈這個無所謂它每一圈Sector的數量是一定的

但是你有不同的track所以你需要讀不同track的時候你就有讀寫頭對不對所以這個讀寫頭這個是會移動的所以他為了要移動track其實他是將這個讀寫頭往裡面移或往外移然後你要讀資料所以讀資料的時候今天你可能會讀任何一個sector對不對所以當然他要知道他在第幾個plate然後在第幾個track像這邊來講我們可能要讀的是這個那你要做的事情

這不同的這個plane當然可以同時讀所以沒有關係無所謂那但是呢你就要第一個要把它移到它在它的track的位置對不對所以讀寫token現在並不在這個track而在更外圈那第一個你就要把它移進來移進來之後呢它再把它轉過來這個就是rotation然後才能到你要的位置然後開始做你的讀寫的動

作所以這整個時間就break down成這邊key到的sit time rotation time跟retime所以sit time指的就是你在移動這個磁頭所以我們當時指的就是這個往前往後所以是依據你的track的位置來決定的第二個就是你的rotation time對不對所以就是剛才這個多快你可以轉一圈這件事情那就是depends on你現在的位置有多遠那就是

它的秒數了所以每秒我們說7、200轉那你就知道了嘛對不對這個距離你要移的話都要mini second然後咧找到之後最後咧這個才是read times才是這個真正transfer time就是dependent你的資料的大小對不對所以當然就是你的byte的數量對不对然后去這個去除掉就是你花的時間嘛對不对所以你的bandwidth越高你花的時間就是越短的

所以相對的就是你可以倒推回來如果你知道你今天transfered多少資料量那你也知道它request從一開始進去到完成它的時間你當然就可以算出它的bandwidth那就是整個它的時間的modeling就是長得像這樣子那這三個時間你可以注意到第一個這個時間呢跟Disk的scheduling無關，因為這是跟資料量有關所以今天我們說你讀寫是一個

Sequential IO，你一次讀很多的bytes出來，跟你把同樣的size但是你把它結碎然後散落在各地那當然時間不同，但這個是使用者的問題，這個Disk controller不能做任何事，所以這個部分只跟使用者的behavior有關IO的pattern有關這個沒有辦法去優化它。 Rotation time基本上也是非常快的，因為你想想看每秒鐘7,200轉所以這個基本上你要從這裡 shift

到這裡是非常非常快的，那 7,200 重點在哪只是在於說當你找到之後，如果我要讀的資料量很大，所以他可能要讀好幾圈對不對那當然時間就會變得非常的快，那你讀寫就會快所以這後面 bandwidth 跟這個時間也是有相關，但這兩個時間其實相對都是很快的也不需要特別去優化。但最後一個 sig pine

其實呢 這個才是Disc這一種Hard Drive它的Performance最大的問題就是因為這個移動磁頭它是一個機械式的行為所以它跟電子的這個所以為什麼SSD會快嘛就是它沒有機械嘛它是不一樣的原理所以這個移動磁頭其實是很好時間的，所以光是從最內圈移到最外圈或這個就會花非常多的時間所以当

我们在谈scheduling的时候其实目的就是要去minimize的读写时间的重点就是要去minimize sigtime因为移动词头很慢而且这个是跟你的IO request是单一IO request无关可是跟所有人IO request读取的顺序是有关的简单来讲就是今天如果我們讀取的資料使用者要的是剛好在每個Track都有一個Data一個Sect

要把它讀出來如果你依序讀跟你在那邊Random跳的讀磁頭移動的距離當然差別非常大啦所以它的時間就會差非常非常的多好所以為什麼Disk Scheduling其實對於整個Disk的Performance很重要因為就是它可以去MinimizeSigTime所以就是可以去minimize是個constant的overhead比較constant而是個overhead就是多餘的時間那這個當然這個現象當然也是只有Disk像這種有磁盤或是CD-ROM這種類型的Store System會有的所以當然你SSD啊其他的對不對Store Device它的管理又會不一樣重點不一樣好那所以這要留到下一次了.